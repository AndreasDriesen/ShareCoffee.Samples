(function(){var n,r,t=function(n,t){return function(){return n.apply(t,arguments)}},i=[].slice,f={}.hasOwnProperty,u=function(n,t){function r(){this.constructor=n}for(var i in t)f.call(t,i)&&(n[i]=t[i]);return r.prototype=t.prototype,n.prototype=new r,n.__super__=t.prototype,n};n=typeof window!="undefined"&&window!==null?window:global;n.ShareCoffee||(n.ShareCoffee={});n.ShareCoffee.CSOM=function(){function n(){}return n.getHostWeb=function(n,t){var i;return i=new SP.AppContextSite(n,t),i.get_web()},n}();n=typeof window!="undefined"&&window!==null?window:global;n.ShareCoffee||(n.ShareCoffee={});n.ShareCoffee.Commons=function(){function n(){}return n.getQueryString=function(){return document.URL.split("?")[1]},n.getQueryStringParameter=function(n){var t,r,i,u;return i=document.URL.split("?")[1].split("&"),r=function(){var r,f,u;for(u=[],r=0,f=i.length;r<f;r++)t=i[r],t.split("=")[0]===n&&u.push(t.split("=")[1]);return u}(),(u=r[0])!=null?u:""},n.getAppWebUrl=function(){var n;return ShareCoffee.Commons.loadAppWebUrlFrom!=null?ShareCoffee.Commons.loadAppWebUrlFrom():typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!==null&&_spPageContextInfo.webAbsoluteUrl!=null?_spPageContextInfo.webAbsoluteUrl:(n=ShareCoffee.Commons.getQueryStringParameter("SPAppWebUrl"),n?decodeURIComponent(n):(console&&console.error&&console.error("_spPageContextInfo is not defined"),""))},n.getHostWebUrl=function(){var n;return(n=ShareCoffee.Commons.getQueryStringParameter("SPHostUrl"),ShareCoffee.Commons.loadHostWebUrlFrom!=null)?ShareCoffee.Commons.loadHostWebUrlFrom():n?decodeURIComponent(n):(console&&console.error&&console.error("SPHostUrl is not defined in the QueryString"),"")},n.getApiRootUrl=function(){return""+ShareCoffee.Commons.getAppWebUrl()+"/_api/"},n.getFormDigest=function(){return document.getElementById("__REQUESTDIGEST").value},n}();n=typeof global!="undefined"&&global!==null?global:window;n.ShareCoffee||(n.ShareCoffee={});n.ShareCoffee.Core=function(){function n(){}return n.checkConditions=function(n,t){if(t()===!1){console&&console.error&&console.error(n);throw n;}},n.loadScript=function(n,t,i){var u,r;return r=document.createElement("script"),u=document.getElementsByTagName("head").item(0),r.type="text/javascript",r.src=n,r.onload=t,r.onerror=i,u.appendChild(r)},n}();n=typeof window!="undefined"&&window!==null?window:global;n.ShareCoffee||(n.ShareCoffee={});n.ShareCoffee.CrossDomainRESTFactory=function(){function n(n,i){this.method=n;this.updateQuery=i!=null?i:!1;this.SPCrossDomainLib=t(this.SPCrossDomainLib,this)}return n.prototype.SPCrossDomainLib=function(n){var t,i;if(t=new ShareCoffee.CrossDomain.SharePointRestProperties,t.extend(n),ShareCoffee.CrossDomain.crossDomainLibrariesLoaded===!1)throw"Cross Domain Libraries not loaded, call ShareCoffee.CrossDomain.loadCrossDomainLibrary() before acting with the CrossDomain REST libraries";return(this.method==="DELETE"||this.updateQuery===!0&&t.eTag==null)&&(t.eTag="*"),i={url:t.hostWebUrl!=null?""+ShareCoffee.Commons.getApiRootUrl()+"SP.AppContextSite(@target)/"+t.url+"?@target='"+t.hostWebUrl+"'":""+ShareCoffee.Commons.getApiRootUrl()+t.url,method:this.method,success:t.onSuccess,error:t.onError,headers:{Accept:ShareCoffee.REST.applicationType,"Content-Type":ShareCoffee.REST.applicationType,"X-HTTP-Method":"MERGE","If-Match":t.eTag},body:typeof t.payload=="string"?t.payload:JSON.stringify(t.payload)},this.method==="GET"&&(delete i.headers["X-RequestDigest"],delete i.headers["Content-Type"]),this.method==="POST"&&t.eTag!=null||delete i.headers["X-HTTP-Method"],this.method==="DELETE"||this.method==="POST"&&t.eTag!=null||delete i.headers["If-Match"],t.onSuccess==null&&delete i.success,t.onError==null&&delete i.error,this.method!=="POST"&&delete i.body,i},n}();n.ShareCoffee.CrossDomain=function(){function n(){}return n.crossDomainLibrariesLoaded=!1,n.loadCSOMCrossDomainLibraries=function(n,t){var i,r,u,f,e=this;return i=function(){return ShareCoffee.CrossDomain.crossDomainLibrariesLoaded=!1,t?t():void 0},u=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.Runtime.js",f=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.js",r=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.RequestExecutor.js",ShareCoffee.Core.loadScript(u,function(){return ShareCoffee.Core.loadScript(f,function(){return ShareCoffee.Core.loadScript(r,function(){return ShareCoffee.CrossDomain.crossDomainLibrariesLoaded=!0,n?n():void 0},i)},i)},i)},n.loadCrossDomainLibrary=function(n,t){var i,r,u=this;return i=function(){return ShareCoffee.CrossDomain.crossDomainLibrariesLoaded=!1,t?t():void 0},r=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.RequestExecutor.js",ShareCoffee.Core.loadScript(r,function(){return ShareCoffee.CrossDomain.crossDomainLibrariesLoaded=!0,n?n():void 0},i)},n.build={create:{"for":new ShareCoffee.CrossDomainRESTFactory("POST")},read:{"for":new ShareCoffee.CrossDomainRESTFactory("GET")},update:{"for":new ShareCoffee.CrossDomainRESTFactory("POST",!0)},"delete":{"for":new ShareCoffee.CrossDomainRESTFactory("DELETE")}},n.getClientContext=function(){var n,t,i;if(ShareCoffee.CrossDomain.crossDomainLibrariesLoaded===!1)throw"Cross Domain Libraries not loaded, call ShareCoffee.CrossDomain.loadCrossDomainLibrary() before acting with the ClientCotext";return n=ShareCoffee.Commons.getAppWebUrl(),t=new SP.ClientContext(n),i=new SP.ProxyWebRequestExecutorFactory(n),t.set_webRequestExecutorFactory(i),t},n.getHostWeb=function(n,t){var i;if(t==null&&(t=ShareCoffee.Commons.getHostWebUrl()),ShareCoffee.CrossDomain.crossDomainLibrariesLoaded===!1)throw"Cross Domain Libraries not loaded, call ShareCoffee.CrossDomain.loadCrossDomainLibrary() before acting with the ClientCotext";if(n==null)throw"ClientContext cant be null, call ShareCoffee.CrossDomain.getClientContext() first";return i=new SP.AppContextSite(n,t),i.get_web()},n}();n.ShareCoffee.CrossDomain.SharePointRestProperties=function(){function n(n,i,r,u,f,e){this.url=n;this.payload=i;this.hostWebUrl=r;this.eTag=u;this.onSuccess=f;this.onError=e;this.extend=t(this.extend,this);this.url==null&&(this.url=null);this.payload==null&&(this.payload=null);this.hostWebUrl==null&&(this.hostWebUrl=null);this.eTag==null&&(this.eTag=null);this.onSuccess==null&&(this.onSuccess=null);this.onError==null&&(this.onError=null)}return n.prototype.extend=function(){var t,r,u,f,n,e;for(u=1<=arguments.length?i.call(arguments,0):[],n=0,e=u.length;n<e;n++){r=u[n];for(t in r)f=r[t],this[t]=f}},n}();n=typeof window!="undefined"&&window!==null?window:global;n.ShareCoffee||(n.ShareCoffee={});n.ShareCoffee.RESTFactory=function(){function n(n,i){this.method=n;this.updateQuery=i!=null?i:!1;this.reqwest=t(this.reqwest,this);this.angularJS=t(this.angularJS,this);this.jQuery=t(this.jQuery,this)}return n.prototype.jQuery=function(n){var t,i;return t=new ShareCoffee.REST.jQueryProperties,t.extend(n),(this.method==="DELETE"||this.updateQuery===!0&&t.eTag==null)&&(t.eTag="*"),i={url:t.getUrl(),type:this.method,contentType:ShareCoffee.REST.applicationType,headers:{Accept:ShareCoffee.REST.applicationType,"X-RequestDigest":ShareCoffee.Commons.getFormDigest(),"X-HTTP-Method":"MERGE","If-Match":t.eTag},data:typeof t.payload=="string"?t.payload:JSON.stringify(t.payload)},this.method==="GET"&&(delete i.contentType,delete i.headers["X-RequestDigest"]),this.method==="POST"&&t.eTag!=null||delete i.headers["X-HTTP-Method"],this.method==="DELETE"||this.method==="POST"&&t.eTag!=null||delete i.headers["If-Match"],this.method!=="POST"&&delete i.data,i},n.prototype.angularJS=function(n){var t,i;return t=new ShareCoffee.REST.angularProperties,t.extend(n),(this.method==="DELETE"||this.updateQuery===!0&&t.eTag==null)&&(t.eTag="*"),i={url:t.getUrl(),method:this.method,headers:{Accept:ShareCoffee.REST.applicationType,"Content-Type":ShareCoffee.REST.applicationType,"X-RequestDigest":ShareCoffee.Commons.getFormDigest(),"X-HTTP-Method":"MERGE","If-Match":t.eTag},data:typeof t.payload=="string"?t.payload:JSON.stringify(t.payload)},this.method==="GET"&&(delete i.headers["Content-Type"],delete i.headers["X-RequestDigest"]),this.method==="POST"&&t.eTag!=null||delete i.headers["X-HTTP-Method"],this.method==="DELETE"||this.method==="POST"&&t.eTag!=null||delete i.headers["If-Match"],this.method!=="POST"&&delete i.data,i},n.prototype.reqwest=function(n){var r,t,i;t=new ShareCoffee.REST.reqwestProperties;t.extend(n);(this.method==="DELETE"||this.updateQuery===!0&&t.eTag==null)&&(t.eTag="*");i=null;try{i={url:t.getUrl(),type:"json",method:this.method.toLowerCase(),contentType:ShareCoffee.REST.applicationType,headers:{Accept:ShareCoffee.REST.applicationType,"X-RequestDigest":ShareCoffee.Commons.getFormDigest(),"If-Match":t.eTag,"X-HTTP-Method":"MERGE"},data:t.payload!=null&&typeof t.payload=="string"?t.payload:JSON.stringify(t.payload),success:t.onSuccess,error:t.onError};this.method==="GET"&&(delete i.contentType,delete i.headers["X-RequestDigest"]);this.method==="POST"&&t.eTag!=null||delete i.headers["X-HTTP-Method"];this.method==="DELETE"||this.method==="POST"&&t.eTag!=null||delete i.headers["If-Match"];this.method!=="POST"&&delete i.data;t.onSuccess==null&&delete i.success;t.onError==null&&delete i.error}catch(u){r=u;throw"please provide either a json string or an object as payload";}return i},n}();n.ShareCoffee.REST=function(){function n(){}return n.applicationType="application/json;odata=verbose",n.build={create:{"for":new ShareCoffee.RESTFactory("POST")},read:{"for":new ShareCoffee.RESTFactory("GET")},update:{"for":new ShareCoffee.RESTFactory("POST",!0)},"delete":{"for":new ShareCoffee.RESTFactory("DELETE")}},n}();n.ShareCoffee.REST.angularProperties=function(){function n(n,i,r,u){this.url=n;this.payload=i;this.hostWebUrl=r;this.eTag=u;this.extend=t(this.extend,this);this.getUrl=t(this.getUrl,this);this.url==null&&(this.url=null);this.payload==null&&(this.payload=null);this.hostWebUrl==null&&(this.hostWebUrl=null);this.eTag==null&&(this.eTag=null)}return n.prototype.getUrl=function(){return this.hostWebUrl!=null?this.url.indexOf("?")===-1?""+ShareCoffee.Commons.getApiRootUrl()+"SP.AppContextSite(@target)/"+this.url+"?@target='"+this.hostWebUrl+"'":""+ShareCoffee.Commons.getApiRootUrl()+"SP.AppContextSite(@target)/"+this.url+"&@target='"+this.hostWebUrl+"'":""+ShareCoffee.Commons.getApiRootUrl()+this.url},n.prototype.extend=function(){var t,r,u,f,n,e;for(u=1<=arguments.length?i.call(arguments,0):[],n=0,e=u.length;n<e;n++){r=u[n];for(t in r)f=r[t],this[t]=f}},n}();n.ShareCoffee.REST.jQueryProperties=function(n){function t(){return r=t.__super__.constructor.apply(this,arguments)}return u(t,n),t}(n.ShareCoffee.REST.angularProperties);n.ShareCoffee.REST.reqwestProperties=function(n){function t(n,i,r,u,f,e){this.url=n;this.payload=i;this.hostWebUrl=r;this.eTag=u;this.onSuccess=f;this.onError=e;t.__super__.constructor.call(this,this.url,this.payload,this.hostWebUrl,this.eTag);this.onSuccess==null&&(this.onSuccess=null);this.onError==null&&(this.onError=null)}return u(t,n),t}(n.ShareCoffee.REST.angularProperties);n=typeof window!="undefined"&&window!==null?window:global;n.ShareCoffee||(n.ShareCoffee={});n.ShareCoffee.SettingsLink=function(n,t,i){return i==null&&(i=!1),{linkUrl:i?""+n+"?"+ShareCoffee.Commons.getQueryString():n,displayName:t}};n.ShareCoffee.ChromeSettings=function(){var n,t,r,u;return t=arguments[0],u=arguments[1],n=arguments[2],r=4<=arguments.length?i.call(arguments,3):[],{appIconUrl:t,appTitle:u,appHelpPageUrl:n,settingsLinks:r}};n.ShareCoffee.UI=function(){function n(){}return n.showNotification=function(n,t){var i;return t==null&&(t=!1),i=function(){return typeof SP!="undefined"&&SP!==null&&SP.UI!=null&&SP.UI.Notify!=null&&SP.UI.Notify.addNotification!=null},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Notify is not defined (check if core.js is loaded)",i),SP.UI.Notify.addNotification(n,t)},n.removeNotification=function(n){var t;if(n!=null)return t=function(){return typeof SP!="undefined"&&SP!==null&&SP.UI!=null&&SP.UI.Notify!=null&&SP.UI.Notify.removeNotification!=null},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Notify is not defined (check if core.js is loaded)",t),SP.UI.Notify.removeNotification(n)},n.showStatus=function(n,t,i,r){var f,u;return i==null&&(i=!1),r==null&&(r="blue"),f=function(){return typeof SP!="undefined"&&SP!==null&&SP.UI!=null&&SP.UI.Status!=null&&SP.UI.Status.addStatus!=null&&SP.UI.Status.setStatusPriColor!=null},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",f),u=SP.UI.Status.addStatus(n,t,i),SP.UI.Status.setStatusPriColor(u,r),u},n.removeStatus=function(n){var t;if(n!=null)return t=function(){return typeof SP!="undefined"&&SP!==null&&SP.UI!=null&&SP.UI.Status!=null&&SP.UI.Status.removeStatus!=null},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",t),SP.UI.Status.removeStatus(n)},n.removeAllStatus=function(){var n;return n=function(){return typeof SP!="undefined"&&SP!==null&&SP.UI!=null&&SP.UI.Status!=null&&SP.UI.Status.removeAllStatus!=null},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",n),SP.UI.Status.removeAllStatus()},n.setStatusColor=function(n,t){var i;if(t==null&&(t="blue"),n!=null)return i=function(){return typeof SP!="undefined"&&SP!==null&&SP.UI!=null&&SP.UI.Status!=null&&SP.UI.Status.setStatusPriColor!=null},ShareCoffee.Core.checkConditions("SP, SP.UI or SP.UI.Status is not defined! (check if core.js is loaded)",i),SP.UI.Status.setStatusPriColor(n,t)},n.onChromeLoadedCallback=null,n.loadAppChrome=function(n,t,i){var r,u,f=this;return i==null&&(i=void 0),i!=null&&(ShareCoffee.UI.onChromeLoadedCallback=i,t.onCssLoaded="ShareCoffee.UI.onChromeLoadedCallback()"),r=function(){var i;return i=new SP.UI.Controls.Navigation(n,t),i.setVisible(!0)},u=""+ShareCoffee.Commons.getHostWebUrl()+"/_layouts/15/SP.UI.Controls.js",ShareCoffee.Core.loadScript(u,r,function(){throw"Error loading SP.UI.Controls.js";})},n}()}).call(this);
//# sourceMappingURL=ShareCoffee.min.js.map